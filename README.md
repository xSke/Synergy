Fair warning, this is probably the worst code I have ever written.
